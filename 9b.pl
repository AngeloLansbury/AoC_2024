@t = (0, 0, 1, 3, 6, 10, 15, 21, 28, 36);

($i, @c) = (0, split(//, <STDIN>));
push(@b, [$i++, $_[0]], [-1, $_[1], 0]) while @_ = splice(@c, 0, 2);
pop @b;

$i = $#b;
while ($i >= 0) {
  $t = 1;
  while ($t < $i) {
    if (${$b[$t]}[1] - ${$b[$t]}[2] >= ${$b[$i]}[1]) {
      ${$b[$t]}[2] += ${$b[$i]}[1];
      push(@{$b[$t]}, ${$b[$i]}[0], ${$b[$i]}[1]);
      ${$b[$i]}[0] = -1;
      last;
    }
    $t += 2;
  }
  $i -= 2;
}

$i = 0;
while (@p = @{shift(@b)}) {
  if ($p[0] >= 0) {
    $s += ($i * $p[1] + $t[$p[1]]) * $p[0];
    $i += $p[1];
  } else {
    if ($p[2] > 0) {
      $m = 3;
      while ($m < $#p) {
        $s += ($i * $p[$m + 1] + $t[$p[$m + 1]]) * $p[$m];
        $i += $p[$m + 1];
        $m += 2;
      }
    }
    $i += $p[1] - $p[2];
  }
}
print $s;
